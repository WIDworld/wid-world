// -------------------------------------------------------------------------- //
// Export countries and region codes
// -------------------------------------------------------------------------- //

import excel "$country_codes/country-codes-core.xlsx", clear firstrow

keep if shortname != ""
rename code iso

// -------------------------------------------------------------------------- //
// Countries only
// -------------------------------------------------------------------------- //

preserve
	drop if inrange(iso, "QB", "QZ") | iso == "WO"  | inrange(iso, "OA", "OJ") ///
	| inrange(iso, "XA", "XF") | inrange(iso, "XL", "XS")
	label data "Generated by import-country-codes.do"
	save "$work_data/import-country-codes-output.dta", replace
restore

// -------------------------------------------------------------------------- //
// Regions (PPP)
// -------------------------------------------------------------------------- //

preserve
	keep if inrange(iso, "QB", "QZ") | iso == "WO"  | inrange(iso, "OA", "OJ") ///
	| inrange(iso, "XA", "XF") | inrange(iso, "XL", "XS")
	keep iso titlename shortname
	
	generate matchname = shortname
	
*	replace titlename = titlename + " (at purchasing power parity)"
*	replace shortname = shortname + " (at purchasing power parity)"
	
	label data "Generated by import-country-codes.do"
	save "$work_data/import-region-codes-output.dta", replace
restore

// -------------------------------------------------------------------------- //
// Regions (MER)
// -------------------------------------------------------------------------- //

preserve
	keep if inrange(iso, "QB", "QZ") | iso == "WO"  | inrange(iso, "OA", "OJ") ///
	| inrange(iso, "XA", "XF") | inrange(iso, "XL", "XS")
	keep iso titlename shortname
	
	replace iso = iso + "-MER"
	replace titlename = titlename + " (at market exchange rate)"
	replace shortname = shortname + " (at market exchange rate)"
	
	label data "Generated by import-country-codes.do"
	save "$work_data/import-region-codes-mer-output.dta", replace
restore
